!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("Clappr")):"function"==typeof define&&define.amd?define(["Clappr"],t):"object"==typeof exports?exports.RTMP=t(require("Clappr")):e.RTMP=t(e.Clappr)}(this,function(e){return function(e){function t(n){if(i[n])return i[n].exports;var a=i[n]={exports:{},id:n,loaded:!1};return e[n].call(a.exports,a,a.exports,t),a.loaded=!0,a.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var a=i(1),r=n(a);e.exports=window.RTMP=r["default"]},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function a(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function r(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function o(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Object.defineProperty(t,"__esModule",{value:!0});var s=function m(e,t,i){null===e&&(e=Function.prototype);var n=Object.getOwnPropertyDescriptor(e,t);if(void 0===n){var a=Object.getPrototypeOf(e);return null===a?void 0:m(a,t,i)}if("value"in n)return n.value;var r=n.get;if(void 0!==r)return r.call(i)},l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),u=i(2),p=i(3),c=n(p),f=i(4),h=n(f),g=i(5),y=n(g),d=function(e){function t(e){a(this,t);var i=r(this,Object.getPrototypeOf(t).call(this,e));return i.options=e,i.options.rtmpConfig=i.options.rtmpConfig||{},i.options.rtmpConfig.swfPath=i.options.rtmpConfig.swfPath||"//cdn.jsdelivr.net/clappr.rtmp/latest/assets/RTMP.swf",i.options.rtmpConfig.wmode=i.options.rtmpConfig.wmode||"transparent",i.options.rtmpConfig.bufferTime=void 0===i.options.rtmpConfig.bufferTime?.1:i.options.rtmpConfig.bufferTime,i.options.rtmpConfig.scaling=i.options.rtmpConfig.scaling||"letterbox",i.options.rtmpConfig.playbackType=i.options.rtmpConfig.playbackType||i.options.src.indexOf("live")>-1,i.options.rtmpConfig.startLevel=void 0===i.options.rtmpConfig.startLevel?-1:i.options.rtmpConfig.startLevel,i.setupPlaybackType(),i}return o(t,e),l(t,[{key:"name",get:function(){return"rtmp"}},{key:"tagName",get:function(){return"object"}},{key:"template",get:function(){return(0,c["default"])(h["default"])}},{key:"attributes",get:function(){return{"data-rtmp":"",type:"application/x-shockwave-flash",width:"100%",height:"100%"}}}]),l(t,[{key:"getPlaybackType",value:function(){return this.playbackType}},{key:"addListeners",value:function(){u.Mediator.on(this.uniqueId+":progress",this.progress,this),u.Mediator.on(this.uniqueId+":timeupdate",this.updateTime,this),u.Mediator.on(this.uniqueId+":statechanged",this.checkState,this),u.Mediator.on(this.uniqueId+":playbackready",this.playbackReady,this),u.Mediator.on(this.uniqueId+":onloaded",this.reporLevels,this),u.Mediator.on(this.uniqueId+":levelChanging",this.levelChanging,this),u.Mediator.on(this.uniqueId+":levelChanged",this.levelChange,this),u.Mediator.on(this.uniqueId+":flashready",this.bootstrap,this)}},{key:"stopListening",value:function(){s(Object.getPrototypeOf(t.prototype),"stopListening",this).call(this),u.Mediator.off(this.uniqueId+":progress"),u.Mediator.off(this.uniqueId+":timeupdate"),u.Mediator.off(this.uniqueId+":statechanged"),u.Mediator.off(this.uniqueId+":flashready")}},{key:"bootstrap",value:function(){this.el.width="100%",this.el.height="100%",this.options.autoPlay&&this.play(),this.setupSettings()}},{key:"updateTime",value:function(){"live"===this.getPlaybackType()?this.trigger(u.Events.PLAYBACK_TIMEUPDATE,{current:1,total:1},this.name):this.trigger(u.Events.PLAYBACK_TIMEUPDATE,{current:this.el.getPosition(),total:this.el.getDuration()},this.name)}},{key:"levelChanging",value:function(){this.trigger(u.Events.PLAYBACK_LEVEL_SWITCH_START)}},{key:"levelChange",value:function(){this.trigger(u.Events.PLAYBACK_LEVEL_SWITCH_END)}},{key:"findLevelBy",value:function(e){var t;return this.levels.forEach(function(i){i.id===e&&(t=i)}),t}},{key:"setupPlaybackType",value:function(){this.playbackType=this.options.rtmpConfig.playbackType}},{key:"setupSettings",value:function(){"live"===this.getPlaybackType()?(this.settings.left=["playpause"],this.settings.right=["fullscreen","volume"],this.settings.seekEnabled=!1):(this.settings.left=["playpause","position","duration"],this.settings.right=["fullscreen","volume"]),this.trigger(u.Events.PLAYBACK_SETTINGSUPDATE)}},{key:"render",value:function(){this.$el.html(this.template({cid:this.cid,swfPath:this.swfPath,playbackId:this.uniqueId,wmode:this.options.rtmpConfig.wmode,scaling:this.options.rtmpConfig.scaling,bufferTime:this.options.rtmpConfig.bufferTime,playbackType:this.options.rtmpConfig.playbackType,startLevel:this.options.rtmpConfig.startLevel})),u.Browser.isIE?(this.$("embed").remove(),u.Browser.isLegacyIE&&this.$el.attr("classid",IE_CLASSID)):u.Browser.isFirefox&&this.setupFirefox(),this.el.id=this.cid;var e=u.Styler.getStyleFor(y["default"]);return this.$el.append(e),this}},{key:"checkState",value:function(){s(Object.getPrototypeOf(t.prototype),"checkState",this).call(this),"PLAYING"===this.el.getState()&&this.trigger(u.Events.PLAYBACK_PLAY,this.name)}},{key:"playbackReady",value:function(){this.isReadyState=!0,this.trigger(u.Events.PLAYBACK_READY,this.name)}},{key:"reporLevels",value:function(){this.isDynamicStream&&this.levels&&this.trigger(u.Events.PLAYBACK_LEVELS_AVAILABLE,this.levels,this.options.rtmpConfig.startLevel)}},{key:"swfPath",get:function(){return this.options.rtmpConfig.swfPath}},{key:"currentLevel",get:function(){return this.el.getCurrentLevel()},set:function(e){this.el.setLevel(e)}},{key:"numLevels",get:function(){return this.el.getNumLevels()}},{key:"autoSwitchLevels",get:function(){return this.el.isAutoSwitchLevels()}},{key:"levels",get:function(){for(var e=[],t=0;t<this.numLevels;t++){var i=this.el.getBitrateForLevel(t);e.push({id:t,label:i+"Kbps"})}return e}},{key:"isDynamicStream",get:function(){return this.el.isDynamicStream()}}]),t}(u.Flash);t["default"]=d,d.canPlay=function(e){return!(!(e.indexOf("rtmp://")>-1||e.indexOf(".smil")>-1)||!u.Browser.hasFlash)},d.debug=function(e){return console.log(e)}},function(t,i){t.exports=e},function(e,t){"use strict";var i={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g},n=/(.)^/,a={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},r=/\\|'|\r|\n|\t|\u2028|\u2029/g,o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"},s=new RegExp("[&<>\"']","g"),l=function(e){return null===e?"":(""+e).replace(s,function(e){return o[e]})},u=0,p=function(e,t){var o,s=new RegExp([(i.escape||n).source,(i.interpolate||n).source,(i.evaluate||n).source].join("|")+"|$","g"),p=0,c="__p+='";e.replace(s,function(t,i,n,o,s){return c+=e.slice(p,s).replace(r,function(e){return"\\"+a[e]}),i&&(c+="'+\n((__t=("+i+"))==null?'':escapeExpr(__t))+\n'"),n&&(c+="'+\n((__t=("+n+"))==null?'':__t)+\n'"),o&&(c+="';\n"+o+"\n__p+='"),p=s+t.length,t}),c+="';\n",i.variable||(c="with(obj||{}){\n"+c+"}\n"),c="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+c+"return __p;\n//# sourceURL=/microtemplates/source["+u++ +"]";try{o=new Function(i.variable||"obj","escapeExpr",c)}catch(f){throw f.source=c,f}if(t)return o(t,l);var h=function(e){return o.call(this,e,l)};return h.source="function("+(i.variable||"obj")+"){\n"+c+"}",h};p.settings=i,e.exports=p},function(e,t){e.exports='<param name=movie value="<%= swfPath %>?inline=1"><param name=quality value=autohigh><param name=swliveconnect value=true><param name=allowScriptAccess value=always><param name=allownetworking value=all><param name=bgcolor value=#000000><param name=allowFullScreen value=false><param name=wmode value="<%= wmode %>"><param name=tabindex value=1><param name=FlashVars value="playbackId=<%= playbackId %>&scaling=<%= scaling %>&bufferTime=<%= bufferTime %>&playbackType=<%= playbackType %>&startLevel=<%= startLevel %>"><embed name="<%= cid %>" type=application/x-shockwave-flash disabled tabindex=-1 enablecontextmenu=false allowscriptaccess=always allownetworking=all quality=autohigh pluginspage=http://www.macromedia.com/go/getflashplayer wmode="<%= wmode %>" swliveconnect=true allowfullscreen bgcolor=#000000 flashvars="playbackId=<%= playbackId %>&scaling=<%= scaling %>&bufferTime=<%= bufferTime %>&playbackType=<%= playbackType %>&startLevel=<%= startLevel %>" src="<%= swfPath %>" width=100% height=100%>'},function(e,t){e.exports=".clappr-flash-playback[data-flash-playback]{display:block;position:absolute;top:0;left:0;height:100%;width:100%;pointer-events:none}\n"}])});
//# sourceMappingURL=rtmp.min.js.map